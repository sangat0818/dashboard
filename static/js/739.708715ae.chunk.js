"use strict";(self.webpackChunkbiscuit_admin_dashboard=self.webpackChunkbiscuit_admin_dashboard||[]).push([[739],{2739:(e,t,r)=>{r.r(t),r.d(t,{default:()=>O});var n=r(5043),i=r(267),s=r(3969),a=r(5895),l=r(1244),o=r(6128),c=r(7873),d=r(4799),h=r(3089),x=r(6154),A=r(3699),g=r(6020),f=r(8259),j=r(7443),m=r(756),u=r(6172),p=r(1341),b=r(4375),v=r(3849),y=r(6529),w=r(2579),C=r(2272),S=r(916),k=r(1449),M=r(9982),I=r(3745),N=r(3241),W=r(4573),P=r(3665),R=r(9992),z=r(579);const D=(0,R.A)((0,z.jsx)("path",{d:"M23 8c0 1.1-.9 2-2 2-.18 0-.35-.02-.51-.07l-3.56 3.55c.05.16.07.34.07.52 0 1.1-.9 2-2 2s-2-.9-2-2c0-.18.02-.36.07-.52l-2.55-2.55c-.16.05-.34.07-.52.07s-.36-.02-.52-.07l-4.55 4.56c.05.16.07.33.07.51 0 1.1-.9 2-2 2s-2-.9-2-2 .9-2 2-2c.18 0 .35.02.51.07l4.56-4.55C8.02 9.36 8 9.18 8 9c0-1.1.9-2 2-2s2 .9 2 2c0 .18-.02.36-.07.52l2.55 2.55c.16-.05.34-.07.52-.07s.36.02.52.07l3.55-3.56C19.02 8.35 19 8.18 19 8c0-1.1.9-2 2-2s2 .9 2 2"}),"Timeline");r(5472),r(6860);var E=r(8729),T=r(5180),L=r(7151);const _=(e,t)=>{const r=t.filter((t=>t.reportingToId===e)),n=r.filter((e=>"MarketingStaff"===e.role)),i=r.filter((e=>"MarketingStaff"!==e.role));let s=[...n];return i.forEach((e=>{const r=_(e.id,t);s=[...s,...r]})),s};function O(){const e=(0,i.A)(),t=(0,T.Zp)(),{userProfile:r,allUsers:R,loading:O}=(0,E.A)(),[V,$]=(0,n.useState)(!1),[H,U]=(0,n.useState)(""),[Z,Y]=(0,n.useState)([]),[q,B]=(0,n.useState)([]),[F,G]=(0,n.useState)({open:!1,message:"",severity:"success"}),[J,K]=(0,n.useState)(0),[Q,X]=(0,n.useState)(10);(0,n.useEffect)((()=>{(async()=>{if(r&&R&&0!==R.length){$(!0);try{let e=[];e="Admin"===r.role?R.filter((e=>"MarketingStaff"===e.role)):_(r.id,R),Y(e),await ee(e)}catch(e){console.error("Error loading marketing staff:",e),G({open:!0,message:"Error loading marketing staff data: "+e.message,severity:"error"})}finally{$(!1)}}})()}),[r,R]);const ee=async e=>{if(e&&0!==e.length)try{const t=[];for(const r of e){const e=R.find((e=>e.id===r.reportingToId)),n=new Date;n.setDate(n.getDate()-30),t.push({...r,managerName:(null===e||void 0===e?void 0:e.name)||"N/A",managerRole:(null===e||void 0===e?void 0:e.role)||"N/A",visitCount30Days:Math.floor(30*Math.random()),retailerCount:Math.floor(20*Math.random()),lastActive:new Date(Date.now()-Math.floor(7*Math.random()*24*60*60*1e3))})}B(t)}catch(t){console.error("Error enriching staff data:",t)}else B([])},te=(0,n.useMemo)((()=>q?q.filter((e=>!H.trim()||e.name&&e.name.toLowerCase().includes(H.toLowerCase())||e.phoneNumber&&e.phoneNumber.includes(H)||e.email&&e.email.toLowerCase().includes(H.toLowerCase()))):[]),[q,H]),re=te.slice(J*Q,J*Q+Q);return(0,L.AI)(r)?(0,z.jsxs)(s.A,{children:[(0,z.jsx)(l.A,{sx:{borderRadius:2,boxShadow:e.shadows[2],mb:4},children:(0,z.jsxs)(o.A,{sx:{p:3},children:[(0,z.jsxs)(s.A,{sx:{display:"flex",alignItems:"center",mb:3},children:[(0,z.jsx)(c.A,{sx:{bgcolor:e.palette.warning.light,color:e.palette.warning.contrastText||"#fff",width:48,height:48,mr:2},children:(0,z.jsx)(M.A,{})}),(0,z.jsxs)(s.A,{children:[(0,z.jsx)(a.A,{variant:"h5",fontWeight:"bold",color:"text.primary",children:"Marketing Staff List"}),(0,z.jsx)(a.A,{variant:"body2",color:"text.secondary",children:"All marketing staff reporting to you (directly or indirectly)"})]})]}),(0,z.jsx)(d.A,{sx:{p:2,mb:4,borderRadius:2},children:(0,z.jsx)(h.A,{container:!0,spacing:2,alignItems:"center",children:(0,z.jsx)(h.A,{item:!0,xs:12,children:(0,z.jsx)(x.A,{label:"Search by Name, Email or Phone",type:"text",size:"small",fullWidth:!0,value:H,onChange:e=>U(e.target.value),InputProps:{startAdornment:(0,z.jsx)(A.A,{position:"start",children:(0,z.jsx)(I.A,{sx:{color:e.palette.warning.main}})})},sx:{"& .MuiOutlinedInput-root":{borderRadius:2}}})})})}),V?(0,z.jsxs)(s.A,{sx:{mb:2},children:[(0,z.jsx)(g.A,{sx:{height:6,borderRadius:3}}),(0,z.jsx)(f.A,{children:(0,z.jsxs)(j.A,{children:[(0,z.jsx)(m.A,{children:(0,z.jsxs)(u.A,{children:[(0,z.jsx)(p.A,{sx:{fontWeight:"bold"},children:"Marketing Staff"}),(0,z.jsx)(p.A,{sx:{fontWeight:"bold"},children:"Contact Info"}),(0,z.jsx)(p.A,{sx:{fontWeight:"bold"},children:"Reports To"}),(0,z.jsx)(p.A,{sx:{fontWeight:"bold",textAlign:"center"},children:"Actions"})]})}),(0,z.jsx)(b.A,{children:[...Array(5)].map(((e,t)=>(0,z.jsxs)(u.A,{children:[(0,z.jsx)(p.A,{children:(0,z.jsxs)(s.A,{sx:{display:"flex",alignItems:"center"},children:[(0,z.jsx)(v.A,{variant:"circular",width:40,height:40,sx:{mr:1.5}}),(0,z.jsx)(v.A,{variant:"text",width:150})]})}),(0,z.jsx)(p.A,{children:(0,z.jsx)(v.A,{variant:"text",width:180})}),(0,z.jsx)(p.A,{children:(0,z.jsx)(v.A,{variant:"text",width:150})}),(0,z.jsx)(p.A,{align:"center",children:(0,z.jsxs)(s.A,{sx:{display:"flex",justifyContent:"center",gap:1},children:[(0,z.jsx)(v.A,{variant:"circular",width:32,height:32}),(0,z.jsx)(v.A,{variant:"circular",width:32,height:32})]})})]},t)))})]})})]}):0===te.length?(0,z.jsx)(s.A,{sx:{textAlign:"center",p:4,bgcolor:"rgba(0,0,0,0.02)",borderRadius:2},children:(0,z.jsx)(a.A,{variant:"body1",color:"text.secondary",children:"No marketing staff found matching your criteria"})}):(0,z.jsxs)(f.A,{children:[(0,z.jsxs)(j.A,{children:[(0,z.jsx)(m.A,{children:(0,z.jsxs)(u.A,{children:[(0,z.jsx)(p.A,{sx:{fontWeight:"bold"},children:"Marketing Staff"}),(0,z.jsx)(p.A,{sx:{fontWeight:"bold"},children:"Contact Info"}),(0,z.jsx)(p.A,{sx:{fontWeight:"bold"},children:"Reports To"}),(0,z.jsx)(p.A,{sx:{fontWeight:"bold",textAlign:"center"},children:"Actions"})]})}),(0,z.jsx)(b.A,{children:0===re.length?(0,z.jsx)(u.A,{children:(0,z.jsx)(p.A,{colSpan:4,align:"center",children:(0,z.jsx)(a.A,{variant:"body2",color:"text.secondary",children:"No matching results found"})})}):re.map((r=>{var n,i;return(0,z.jsxs)(u.A,{sx:{"&:hover":{bgcolor:"rgba(0,0,0,0.04)"}},children:[(0,z.jsx)(p.A,{children:(0,z.jsxs)(s.A,{sx:{display:"flex",alignItems:"center"},children:[(0,z.jsx)(c.A,{sx:{width:40,height:40,mr:1.5,bgcolor:e.palette.warning.main},children:(null===(n=r.name)||void 0===n?void 0:n.charAt(0))||"?"}),(0,z.jsx)(s.A,{children:(0,z.jsx)(a.A,{variant:"body2",fontWeight:500,children:r.name||"Unknown"})})]})}),(0,z.jsx)(p.A,{children:(0,z.jsxs)(s.A,{children:[(0,z.jsxs)(s.A,{sx:{display:"flex",alignItems:"center",mb:.5},children:[(0,z.jsx)(N.A,{sx:{fontSize:16,color:e.palette.warning.main,mr:1}}),(0,z.jsx)(a.A,{variant:"body2",children:r.phoneNumber||"No phone"})]}),(0,z.jsxs)(s.A,{sx:{display:"flex",alignItems:"center"},children:[(0,z.jsx)(W.A,{sx:{fontSize:16,color:e.palette.warning.main,mr:1}}),(0,z.jsx)(a.A,{variant:"body2",children:r.email||"No email"})]})]})}),(0,z.jsx)(p.A,{children:(0,z.jsxs)(s.A,{children:[(0,z.jsx)(a.A,{variant:"body2",fontWeight:500,children:r.managerName||"N/A"}),(0,z.jsx)(a.A,{variant:"caption",color:"text.secondary",children:(null===(i=r.managerRole)||void 0===i?void 0:i.replace(/([A-Z])/g," $1").trim())||"N/A"})]})}),(0,z.jsx)(p.A,{align:"center",children:(0,z.jsxs)(s.A,{sx:{display:"flex",justifyContent:"center",gap:1},children:[(0,z.jsx)(y.A,{title:"View Staff Details",children:(0,z.jsx)(w.A,{size:"small",onClick:()=>{return e=r.id,void t(`/sales/staff/${e}/details`);var e},sx:{bgcolor:e.palette.warning.light,color:e.palette.warning.main,"&:hover":{bgcolor:e.palette.warning.light}},children:(0,z.jsx)(P.A,{fontSize:"small"})})}),(0,z.jsx)(y.A,{title:"View Visit History",children:(0,z.jsx)(w.A,{size:"small",onClick:()=>{return e=r.id,void t(`/staff/${e}/visits`);var e},sx:{bgcolor:e.palette.info.light,color:e.palette.info.main,"&:hover":{bgcolor:e.palette.info.light}},children:(0,z.jsx)(D,{fontSize:"small"})})})]})})]},r.id)}))})]}),(0,z.jsx)(C.A,{rowsPerPageOptions:[10,25,50,100],component:"div",count:te.length,rowsPerPage:Q,page:J,onPageChange:(e,t)=>{K(t)},onRowsPerPageChange:e=>{X(parseInt(e.target.value,10)),K(0)}})]})]})}),(0,z.jsx)(S.A,{open:F.open,autoHideDuration:6e3,onClose:()=>G({...F,open:!1}),anchorOrigin:{vertical:"bottom",horizontal:"center"},children:(0,z.jsx)(k.A,{onClose:()=>G({...F,open:!1}),severity:F.severity,sx:{width:"100%"},children:F.message})})]}):(0,z.jsx)(s.A,{sx:{p:4,textAlign:"center"},children:(0,z.jsx)(a.A,{variant:"h6",color:"error",children:"You are not authorized to view marketing staff list."})})}}}]);
//# sourceMappingURL=739.708715ae.chunk.js.map